{"ast":null,"code":"var _jsxFileName = \"/home/vinicius/atividades/q2/entregas/5A12/react-entrega-s5-hamburgueria-2-0-com-typescript-json-server-vinapro91/src/Provider/authToken.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { createContext, useCallback, useContext, useState } from \"react\";\nimport { api } from \"../Services/api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext({});\n\nconst useAuth = () => {\n  _s();\n\n  const context = useContext(AuthContext);\n\n  if (!context) {\n    throw new Error(\"useAuth must be used witching an AuthProvider\");\n  }\n\n  return context;\n};\n\n_s(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n\nconst AuthProvider = ({\n  children\n}) => {\n  _s2();\n\n  const [data, setData] = useState(() => {\n    const accessToken = localStorage.getItem(\"@HamburgueriaKenzie:accessToken\");\n    const user = localStorage.getItem(\"@HamburgueriaKenzie:user\");\n\n    if (accessToken && user) {\n      return {\n        accessToken,\n        user: JSON.parse(user)\n      };\n    }\n\n    return {};\n  });\n  const signIn = useCallback(async ({\n    email,\n    password\n  }) => {\n    const response = await api.post(\"/login\", {\n      email,\n      password\n    });\n    const {\n      accessToken,\n      user\n    } = response.data;\n    localStorage.setItem(\"@HamburgueriaKenzie:accessToken\", accessToken);\n    localStorage.setItem(\"@HamburgueriaKenzie:user\", user);\n    setData({\n      accessToken,\n      user\n    });\n  }, []);\n  const signOut = useCallback(() => {\n    localStorage.removeItem(\"@HamburgueriaKenzie:accessToken\");\n    localStorage.removeItem(\"@HamburgueriaKenzie:user\");\n    setData({});\n  }, []);\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      accessToken: data.accessToken,\n      user: data.user,\n      signIn,\n      signOut\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 5\n  }, this);\n};\n\n_s2(AuthProvider, \"QSPYk+jCerPJdqalc66QX1xu95g=\");\n\n_c = AuthProvider;\nexport { AuthProvider, useAuth };\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"sources":["/home/vinicius/atividades/q2/entregas/5A12/react-entrega-s5-hamburgueria-2-0-com-typescript-json-server-vinapro91/src/Provider/authToken.tsx"],"names":["React","createContext","useCallback","useContext","useState","api","AuthContext","useAuth","context","Error","AuthProvider","children","data","setData","accessToken","localStorage","getItem","user","JSON","parse","signIn","email","password","response","post","setItem","signOut","removeItem"],"mappings":";;;;AAAA,OAAOA,KAAP,IACEC,aADF,EAGEC,WAHF,EAIEC,UAJF,EAKEC,QALF,QAMO,OANP;AAQA,SAASC,GAAT,QAAoB,iBAApB;;AA6BA,MAAMC,WAAW,gBAAGL,aAAa,CAAkB,EAAlB,CAAjC;;AAEA,MAAMM,OAAO,GAAG,MAAM;AAAA;;AACpB,QAAMC,OAAO,GAAGL,UAAU,CAACG,WAAD,CAA1B;;AACA,MAAI,CAACE,OAAL,EAAc;AACZ,UAAM,IAAIC,KAAJ,CAAU,+CAAV,CAAN;AACD;;AACD,SAAOD,OAAP;AACD,CAND;;GAAMD,O;;AAQN,MAAMG,YAAY,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAAqC;AAAA;;AACxD,QAAM,CAACC,IAAD,EAAOC,OAAP,IAAkBT,QAAQ,CAAY,MAAM;AAChD,UAAMU,WAAW,GAAGC,YAAY,CAACC,OAAb,CAAqB,iCAArB,CAApB;AACA,UAAMC,IAAI,GAAGF,YAAY,CAACC,OAAb,CAAqB,0BAArB,CAAb;;AAEA,QAAIF,WAAW,IAAIG,IAAnB,EAAyB;AACvB,aAAO;AAAEH,QAAAA,WAAF;AAAeG,QAAAA,IAAI,EAAEC,IAAI,CAACC,KAAL,CAAWF,IAAX;AAArB,OAAP;AACD;;AAED,WAAO,EAAP;AACD,GAT+B,CAAhC;AAWA,QAAMG,MAAM,GAAGlB,WAAW,CAAC,OAAO;AAAEmB,IAAAA,KAAF;AAASC,IAAAA;AAAT,GAAP,KAAkD;AAC3E,UAAMC,QAAQ,GAAG,MAAMlB,GAAG,CAACmB,IAAJ,CAAS,QAAT,EAAmB;AAAEH,MAAAA,KAAF;AAASC,MAAAA;AAAT,KAAnB,CAAvB;AAEA,UAAM;AAAER,MAAAA,WAAF;AAAeG,MAAAA;AAAf,QAAwBM,QAAQ,CAACX,IAAvC;AAEAG,IAAAA,YAAY,CAACU,OAAb,CAAqB,iCAArB,EAAwDX,WAAxD;AACAC,IAAAA,YAAY,CAACU,OAAb,CAAqB,0BAArB,EAAiDR,IAAjD;AACAJ,IAAAA,OAAO,CAAC;AAAEC,MAAAA,WAAF;AAAeG,MAAAA;AAAf,KAAD,CAAP;AACD,GARyB,EAQvB,EARuB,CAA1B;AAUA,QAAMS,OAAO,GAAGxB,WAAW,CAAC,MAAM;AAChCa,IAAAA,YAAY,CAACY,UAAb,CAAwB,iCAAxB;AACAZ,IAAAA,YAAY,CAACY,UAAb,CAAwB,0BAAxB;AACAd,IAAAA,OAAO,CAAC,EAAD,CAAP;AACD,GAJ0B,EAIxB,EAJwB,CAA3B;AAKA,sBACE,QAAC,WAAD,CAAa,QAAb;AACE,IAAA,KAAK,EAAE;AACLC,MAAAA,WAAW,EAAEF,IAAI,CAACE,WADb;AAELG,MAAAA,IAAI,EAAEL,IAAI,CAACK,IAFN;AAGLG,MAAAA,MAHK;AAILM,MAAAA;AAJK,KADT;AAAA,cAQGf;AARH;AAAA;AAAA;AAAA;AAAA,UADF;AAYD,CAvCD;;IAAMD,Y;;KAAAA,Y;AAyCN,SAASA,YAAT,EAAuBH,OAAvB","sourcesContent":["import React, {\n  createContext,\n  ReactNode,\n  useCallback,\n  useContext,\n  useState,\n} from \"react\";\n\nimport { api } from \"../Services/api\";\n\ninterface AuthProviderProps {\n  children: ReactNode;\n}\n\ninterface User {\n  email: string;\n  id: string;\n  name: string;\n}\n\ninterface AuthState {\n  accessToken: string;\n  user: User;\n}\n\ninterface SingInCredentials {\n  email: string;\n  password: string;\n}\n\ninterface AuthContextData {\n  user: User;\n  accessToken: string;\n  signIn: ({ email, password }: SingInCredentials) => Promise<void>;\n  signOut: () => void;\n}\n\nconst AuthContext = createContext<AuthContextData>({} as AuthContextData);\n\nconst useAuth = () => {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error(\"useAuth must be used witching an AuthProvider\");\n  }\n  return context;\n};\n\nconst AuthProvider = ({ children }: AuthProviderProps) => {\n  const [data, setData] = useState<AuthState>(() => {\n    const accessToken = localStorage.getItem(\"@HamburgueriaKenzie:accessToken\");\n    const user = localStorage.getItem(\"@HamburgueriaKenzie:user\");\n\n    if (accessToken && user) {\n      return { accessToken, user: JSON.parse(user) };\n    }\n\n    return {} as AuthState;\n  });\n\n  const signIn = useCallback(async ({ email, password }: SingInCredentials) => {\n    const response = await api.post(\"/login\", { email, password });\n\n    const { accessToken, user } = response.data;\n\n    localStorage.setItem(\"@HamburgueriaKenzie:accessToken\", accessToken);\n    localStorage.setItem(\"@HamburgueriaKenzie:user\", user);\n    setData({ accessToken, user });\n  }, []);\n\n  const signOut = useCallback(() => {\n    localStorage.removeItem(\"@HamburgueriaKenzie:accessToken\");\n    localStorage.removeItem(\"@HamburgueriaKenzie:user\");\n    setData({} as AuthState);\n  }, []);\n  return (\n    <AuthContext.Provider\n      value={{\n        accessToken: data.accessToken,\n        user: data.user,\n        signIn,\n        signOut,\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\nexport { AuthProvider, useAuth };\n"]},"metadata":{},"sourceType":"module"}